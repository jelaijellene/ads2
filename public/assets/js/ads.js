// Generated by CoffeeScript 1.3.3
(function() {
  var BrandCtrl, BrandDetailCtrl, CategoryCtrl, CategoryDetailCtrl, CompanyCtrl, CompanyDetailCtrl, MenuCtrl, PhoneDetailCtrl, ProductCtrl, ProductDetailCtrl, ProductListCtrl, UserCartCtrl, UserCatalogCtrl, UserIndexCtrl, UserProfileCtrl, admin, ads, filters, rest;

  ads = angular.module('ads', ['phonecatFilters', 'restService']);

  ads.config([
    '$routeProvider', function($routeProvider) {
      var user;
      user = "/assets/partials/user";
      return $routeProvider.when('/', {
        templateUrl: "" + user + "/index.html",
        controller: UserIndexCtrl
      }).when('/products', {
        templateUrl: '/assets/partials/product-list.html',
        controller: ProductListCtrl
      }).when('/product/:phoneId', {
        templateUrl: '/assets/partials/phone-detail.html',
        controller: PhoneDetailCtrl
      }).when('/catalog', {
        templateUrl: "" + user + "/catalog.html",
        controller: UserCatalogCtrl
      }).when('/cart', {
        templateUrl: "" + user + "/cart.html",
        controller: UserCartCtrl
      }).when('/profile', {
        templateUrl: "" + user + "/profile.html",
        controller: UserProfileCtrl
      }).otherwise({
        redirectTo: '/'
      });
    }
  ]);

  admin = angular.module('admin', ['restService']);

  admin.config([
    '$routeProvider', function($routeProvider) {
      $routeProvider.when('/', {
        templateUrl: '/assets/partials/admin-index.html'
      }).when('/products', {
        templateUrl: '/assets/partials/products.html',
        controller: ProductCtrl
      }).when('/product/:id', {
        templateUrl: '/assets/partials/product-detail.html',
        controller: ProductDetailCtrl
      }).when('/brand', {
        templateUrl: '/assets/partials/brand.html',
        controller: BrandCtrl
      }).when('/brand/:id', {
        templateUrl: '/assets/partials/brand-detail.html',
        controller: BrandDetailCtrl
      }).when('/company', {
        templateUrl: '/assets/partials/company.html',
        controller: CompanyCtrl
      }).when('/company/:id', {
        templateUrl: '/assets/partials/company-detail.html',
        controller: CompanyDetailCtrl
      }).when('/category', {
        templateUrl: '/assets/partials/category.html',
        controller: CategoryCtrl
      }).when('/category/:id', {
        templateUrl: '/assets/partials/category-detail.html',
        controller: CategoryDetailCtrl
      }).when('/catalog').when('/orders').when('/dealers').when('/reports').when('/sms').otherwise({
        redirectTo: '/'
      });
      return this;
    }
  ]);

  filters = angular.module('phonecatFilters', []);

  filters.filter('startFrom', function() {
    return function(input, start) {
      if (angular.isArray(input)) {
        return input.slice(start);
      }
      return input;
    };
  });

  ProductListCtrl = [
    '$scope', '$http', '$filter', function($scope, $http, $filter) {
      $http.get('/product/all.json').success(function(data) {
        return $scope.products = data;
      });
      return this;
    }
  ];

  PhoneDetailCtrl = [
    '$scope', '$routeParams', function($scope, $routeParams) {
      $scope.phoneId = $routeParams.phoneId;
      $scope.hello = function(name) {
        return $scope.msg = "hello " + name;
      };
      return this;
    }
  ];

  ProductCtrl = [
    '$scope', '$http', function($scope, $http) {
      $http.get('/product/all.json').success(function(data) {
        return $scope.products = data;
      });
      $http.get('/company/all.json').success(function(data) {
        return $scope.companies = data;
      });
      $http.get('/category/all.json').success(function(data) {
        return $scope.categories = data;
      });
      $http.get('/brand/all.json').success(function(data) {
        return $scope.brands = data;
      });
      $scope.limit = 20;
      $scope.saved = false;
      $scope.cancel = function() {
        return $scope.product = {};
      };
      $scope.submit = function() {
        console.log(JSON.stringify($scope.product));
        return $http.post('/product/new.json', JSON.stringify($scope.product)).success(function(data) {
          $scope.saved = true;
          $scope.products.push(data);
          $scope.product = {};
          return this;
        });
      };
      $scope["delete"] = function(id) {
        $http["delete"]("/product/" + id + ".json").success(function() {
          return $http.get('/product/all.json').success(function(data) {
            $scope.products = data;
            return this;
          });
        });
        return this;
      };
      return this;
    }
  ];

  ProductDetailCtrl = [
    '$scope', '$routeParams', '$http', function($scope, $routeParams, $http) {
      $http.get('/product/' + $routeParams.id + '.json').success(function(data) {
        return $scope.product = data;
      });
      $http.get('/company/all.json').success(function(data) {
        return $scope.companies = data;
      });
      $http.get('/category/all.json').success(function(data) {
        return $scope.categories = data;
      });
      $http.get('/brand/all.json').success(function(data) {
        return $scope.brands = data;
      });
      $scope.id = $routeParams.id;
      $scope.saved = false;
      $scope.submit = function() {
        console.log(JSON.stringify($scope.product));
        return $http.post('/product/' + $scope.id + '.json', JSON.stringify($scope.product)).success(function() {
          $scope.saved = true;
          return this;
        });
      };
      return this;
    }
  ];

  BrandCtrl = [
    '$scope', '$http', function($scope, $http) {
      $http.get('/brand/all.json').success(function(data) {
        return $scope.brands = data;
      });
      $scope["delete"] = function(id) {
        return $http["delete"]('/brand/' + id + '.json').success(function() {
          return $http.get('/brand/all.json').success(function(data) {
            return $scope.brands = data;
          });
        });
      };
      $scope.submit = function() {
        return $http.post('/brand/new.json', JSON.stringify($scope.brand)).success(function(data) {
          $scope.brands.push(data);
          return $scope.brand = {};
        });
      };
      return this;
    }
  ];

  BrandDetailCtrl = [
    '$scope', '$http', '$routeParams', 'Brand', function($scope, $http, $routeParams, Brand) {
      $scope.id = $routeParams.id;
      $http.get('/brand/' + $scope.id + '.json').success(function(data) {
        return $scope.brand = data;
      });
      $scope.caption = "Cancel";
      $scope.products = Brand.products({
        id: $scope.id
      });
      return $scope.submit = function() {
        return $http.post('/brand/' + $scope.id + '.json', JSON.stringify($scope.brand)).success(function() {
          $scope.saved = true;
          return $scope.caption = "Back";
        });
      };
    }
  ];

  CompanyCtrl = [
    '$scope', '$http', function($scope, $http) {
      $http.get('/company/all.json').success(function(data) {
        return $scope.companies = data;
      });
      $scope["delete"] = function(id) {
        return $http["delete"]('/company/' + id + '.json').success(function() {
          $http.get('/company/all.json').success(function(data) {
            $scope.companies = data;
            return this;
          });
          return this;
        });
      };
      this;

      return $scope.submit = function() {
        return $http.post('/company/new.json', JSON.stringify($scope.company)).success(function(data) {
          $scope.companies.push(data);
          $scope.company = {};
          return this;
        });
      };
    }
  ];

  CompanyDetailCtrl = [
    '$scope', '$routeParams', '$http', function($scope, $routeParams, $http) {
      $http.get('/company/' + $routeParams.id + '.json').success(function(data) {
        return $scope.company = data;
      });
      $scope.caption = "Cancel";
      return $scope.submit = function() {
        return $http.post('/company/' + $routeParams.id + '.json', JSON.stringify($scope.company)).success(function() {
          $scope.saved = true;
          return $scope.caption = "Back";
        });
      };
    }
  ];

  CategoryCtrl = [
    '$scope', '$http', function($scope, $http) {
      $http.get('/category/all.json').success(function(data) {
        return $scope.categories = data;
      });
      $scope["delete"] = function(id) {
        $http["delete"]('/category/' + id + '.json').success(function() {
          $http.get('/category/all.json').success(function(data) {
            return $scope.categories = data;
          });
          return this;
        });
        return this;
      };
      this;

      return $scope.submit = function() {
        return $http.post('/category/new.json', JSON.stringify($scope.category)).success(function(data) {
          $scope.categories.push(data);
          $scope.category = {};
          return this;
        });
      };
    }
  ];

  CategoryDetailCtrl = [
    '$scope', '$routeParams', '$http', function($scope, $routeParams, $http) {
      $http.get('/category/' + $routeParams.id + '.json').success(function(data) {
        return $scope.category = data;
      });
      $scope.caption = "Cancel";
      return $scope.submit = function() {
        return $http.post('/category/' + $routeParams.id + '.json', JSON.stringify($scope.category)).success(function() {
          $scope.saved = true;
          return $scope.caption = "Back";
        });
      };
    }
  ];

  UserCatalogCtrl = [
    '$scope', 'Brand', function($scope, Brand) {
      return this;
    }
  ];

  UserIndexCtrl = [
    '$scope', '$http', function($scope, $http) {
      return this;
    }
  ];

  UserCartCtrl = [
    '$scope', function($scope) {
      return this;
    }
  ];

  UserProfileCtrl = [
    '$scope', '$http', function($scope, $http) {
      $http.get('/profile').success(function(data) {
        return $scope.profile = data;
      });
      this;

      return $scope.submit = function() {
        $http.post('/profile', JSON.stringify($scope.profile)).success(function(data) {
          $scope.profile = data;
          $scope.saved = true;
          return console.log(data);
        });
        return this;
      };
    }
  ];

  MenuCtrl = [
    '$scope', function($scope) {
      $scope.order = 3;
      return this;
    }
  ];

  ads.controller('MenuCtrl', MenuCtrl);

  rest = angular.module('restService', ['ngResource']);

  rest.factory('Product', function($resource) {
    return $resource('/product/:id.json', {
      id: '@id'
    }, {
      query: {
        method: 'GET',
        params: {
          id: 'all'
        },
        isArray: true
      }
    });
  });

  rest.factory('Brand', function($resource) {
    return $resource('/brand/:id.json/:products', {
      id: '@id'
    }, {
      query: {
        method: 'GET',
        params: {
          id: 'all'
        },
        isArray: true
      },
      products: {
        method: 'GET',
        params: {
          products: 'products'
        },
        isArray: true
      }
    });
  });

}).call(this);
